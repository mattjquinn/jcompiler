program = _{ SOI ~ (stmt ~ "\n") * ~ stmt? ~ EOI }

stmt = _{ expr }

expr = { monadicExpr | dyadicExpr | terms }
monadicExpr = { monadicVerb ~ terms }
dyadicExpr = { terms ~ (dyadicVerb ~ terms)+ }
terms = { term+ }
term = _{ number | "(" ~ expr ~ ")" }

monadicVerb = { ">:" | "*:" }
dyadicVerb = { "+" | "*" }
number = { ASCII_DIGIT+ }

WHITESPACE = _{ " " | "\t" }
COMMENT = _{ "NB." ~ (!"\n" ~ ANY)* ~ ("\n" | EOI) }